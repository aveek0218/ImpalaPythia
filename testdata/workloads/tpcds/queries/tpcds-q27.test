====
---- QUERY: TPCDS-Q27
SELECT
  i_item_id,
  s_state,
  AVG(ss_quantity) agg1,
  AVG(ss_list_price) agg2,
  AVG(ss_coupon_amt) agg3,
  AVG(ss_sales_price) agg4
FROM store_sales ss
JOIN date_dim d
  ON (ss.ss_sold_date_sk = d.d_date_sk)
JOIN item i
  ON (ss.ss_item_sk = i.i_item_sk)
JOIN customer_demographics cd
  ON (ss.ss_cdemo_sk = cd.cd_demo_sk)
JOIN store s
  ON (ss.ss_store_sk = s.s_store_sk)
WHERE
  cd_gender = 'M'
  AND cd_marital_status = 'S'
  AND cd_education_status = 'College'
  AND d_year = 2002
  AND s_state IN ('TN', 'SD')
GROUP BY
  i_item_id,
  s_state
ORDER BY
  i_item_id,
  s_state
LIMIT 100
---- RESULTS
'AAAAAAAAAALCAAAA','TN',98,34.31000137329102,55.29999923706055,1.710000038146973
'AAAAAAAAABDBAAAA','TN',56,103.8499984741211,1624.170043945312,59.18999862670898
'AAAAAAAAABEDAAAA','TN',61,85.13999938964844,0,50.22999954223633
'AAAAAAAAABFBAAAA','TN',31,23.54999923706055,0,13.64999961853027
'AAAAAAAAABHAAAAA','TN',93,74.80000305175781,0,21.69000053405762
'AAAAAAAAABMAAAAA','TN',14,109.9700012207031,0,10.98999977111816
'AAAAAAAAACBBAAAA','TN',70,92.87999725341797,555.0999755859375,13
'AAAAAAAAACBCAAAA','TN',53,35.45999908447266,0,21.97999954223633
'AAAAAAAAACDCAAAA','TN',11,57.36999893188477,0,33.27000045776367
'AAAAAAAAACKCAAAA','TN',44,48.70999908447266,0,23.86000061035156
'AAAAAAAAADBBAAAA','TN',88,48.86000061035156,0,9.770000457763672
'AAAAAAAAADHDAAAA','TN',98,39.29999923706055,0,33.79000091552734
'AAAAAAAAADLAAAAA','TN',74,96.73999786376953,0,20.30999946594238
'AAAAAAAAADPCAAAA','TN',79,42.4900016784668,117.6900024414062,3.819999933242798
'AAAAAAAAAEBAAAAA','TN',100,89.95999908447266,0,53.97000122070312
'AAAAAAAAAECEAAAA','TN',73,59.27000045776367,0,5.329999923706055
'AAAAAAAAAEEDAAAA','TN',17,157.0099945068359,0,131.8800048828125
'AAAAAAAAAEMBAAAA','TN',75,33.43000030517578,0,18.3799991607666
'AAAAAAAAAGFDAAAA','TN',72,47.7400016784668,0,17.65999984741211
'AAAAAAAAAGOAAAAA','TN',44,45.72000122070312,177.7899932861328,23.77000045776367
'AAAAAAAAAHCBAAAA','TN',91,73.38999938964844,0,23.47999954223633
'AAAAAAAAAHFBAAAA','TN',44,29.97999954223633,550.1400146484375,12.89000034332275
'AAAAAAAAAHMAAAAA','TN',76,91.93000030517578,0,7.349999904632568
'AAAAAAAAAHNAAAAA','TN',79,69.18000030517578,162.1499938964844,6.21999979019165
'AAAAAAAAAIAAAAAA','TN',80,75.97000122070312,0,22.03000068664551
'AAAAAAAAAIKBAAAA','TN',61,21.79999923706055,0,5.010000228881836
'AAAAAAAAAJABAAAA','TN',98,48.45999908447266,0,36.81999969482422
'AAAAAAAAAJNAAAAA','TN',70,6.880000114440918,0,5.5
'AAAAAAAAAKABAAAA','TN',35,21.39999961853027,0,12.40999984741211
'AAAAAAAAAKMDAAAA','TN',46,37.04999923706055,299.9200134277344,32.59999847412109
'AAAAAAAAAKNAAAAA','TN',95,131.0399932861328,0,129.7200012207031
'AAAAAAAAALEEAAAA','TN',55,17.26000022888184,0,0.3400000035762787
'AAAAAAAAALIDAAAA','TN',33,180.7700042724609,671.0700073242188,135.5700073242188
'AAAAAAAAAMCDAAAA','TN',18,65.05000305175781,456.4800109863281,25.36000061035156
'AAAAAAAAAMJBAAAA','TN',35,35.70000076293945,0,5.710000038146973
'AAAAAAAAAMKAAAAA','TN',74,30.65999984741211,476.4100036621094,21.45999908447266
'AAAAAAAAAMNDAAAA','TN',80,136.8699951171875,0,13.68000030517578
'AAAAAAAAAMOCAAAA','TN',68,57.29999923706055,0,22.92000007629395
'AAAAAAAAANDBAAAA','TN',3,27.85000038146973,0,1.389999985694885
'AAAAAAAAANHCAAAA','TN',85,36.0099983215332,2208.090087890625,29.52000045776367
'AAAAAAAAANIBAAAA','TN',51,132.5,0,51.66999816894531
'AAAAAAAAANJBAAAA','TN',90,68.94000244140625,0,22.75
'AAAAAAAAANKDAAAA','TN',12,143.2700042724609,1021.200012207031,128.9400024414062
'AAAAAAAAAOBBAAAA','TN',97,161.6999969482422,0,143.9100036621094
'AAAAAAAAAOHCAAAA','TN',33,16.32999992370605,0,12.89999961853027
'AAAAAAAAAPGCAAAA','TN',52.5,105.814998626709,0,10.6150004863739
'AAAAAAAABACBAAAA','TN',43,77.61000061035156,0,25.61000061035156
'AAAAAAAABBBBAAAA','TN',20,124.4300003051758,0,85.84999847412109
'AAAAAAAABBJCAAAA','TN',89,34.77999877929688,680.8900146484375,13.90999984741211
'AAAAAAAABDCBAAAA','TN',65,122.6600036621094,0,39.25
'AAAAAAAABDECAAAA','TN',48,18.39999961853027,0,5.519999980926514
'AAAAAAAABFCCAAAA','TN',67,141.5899963378906,0,124.5899963378906
'AAAAAAAABGFEAAAA','TN',10,160.2200012207031,0,113.75
'AAAAAAAABJLBAAAA','TN',48,144.6699981689453,0,107.0500030517578
'AAAAAAAABKACAAAA','TN',85,99.87000274658203,0,49.93000030517578
'AAAAAAAABKFDAAAA','TN',94,34.38000106811523,0,24.75
'AAAAAAAABKKBAAAA','TN',52,82.29000091552734,1733,37.02999877929688
'AAAAAAAABKOAAAAA','TN',92,65.12999725341797,0,35.16999816894531
'AAAAAAAABMAAAAAA','TN',77,119.8499984741211,0,101.870002746582
'AAAAAAAABMFEAAAA','TN',90,140.0899963378906,0,140.0899963378906
'AAAAAAAABMGAAAAA','TN',26,176.6399993896484,0,86.55000305175781
'AAAAAAAABNEBAAAA','TN',82,94.72000122070312,0,12.3100004196167
'AAAAAAAABNEEAAAA','TN',39,14.78999996185303,0,1.919999957084656
'AAAAAAAACAECAAAA','TN',85,161.5700073242188,0,127.6399993896484
'AAAAAAAACBKAAAAA','TN',84,101.4800033569336,0,12.17000007629395
'AAAAAAAACBLDAAAA','TN',49,104.2300033569336,0,89.62999725341797
'AAAAAAAACCEDAAAA','TN',74,82.34999847412109,0,9.880000114440918
'AAAAAAAACCNCAAAA','TN',59,48.61000061035156,0,0
'AAAAAAAACCPBAAAA','TN',38,48.34999847412109,0,22.71999931335449
'AAAAAAAACDGAAAAA','TN',84,197.4199981689453,0,195.4400024414062
'AAAAAAAACDPCAAAA','TN',62,21.56999969482422,0,17.46999931335449
'AAAAAAAACECAAAAA','TN',54,98.97000122070312,2626,77.19000244140625
'AAAAAAAACEEDAAAA','TN',57,93.75,486.1799926757812,24.3700008392334
'AAAAAAAACEJBAAAA','TN',35,142.3000030517578,0,4.260000228881836
'AAAAAAAACFCCAAAA','TN',57,87.25,446.0799865722656,60.20000076293945
'AAAAAAAACFHDAAAA','TN',30,105.3899993896484,0,48.47000122070312
'AAAAAAAACFICAAAA','TN',70,75.19000244140625,0,61.65000152587891
'AAAAAAAACFPDAAAA','TN',29,132.3600006103516,0,6.610000133514404
'AAAAAAAACGKBAAAA','TN',47,73.83000183105469,0,53.88999938964844
'AAAAAAAACHDEAAAA','TN',11,4.920000076293945,21.10000038146973,2.460000038146973
'AAAAAAAACHFCAAAA','TN',34,63.93000030517578,78.20999908447266,12.77999973297119
'AAAAAAAACHLCAAAA','TN',8,151.0599975585938,0,101.2099990844727
'AAAAAAAACIBAAAAA','TN',14,66.06999969482422,0,24.44000053405762
'AAAAAAAACIFBAAAA','TN',88,146.2200012207031,0,95.04000091552734
'AAAAAAAACIKDAAAA','TN',86,96.16999816894531,0,42.31000137329102
'AAAAAAAACIMDAAAA','TN',100,30.61000061035156,0,26.01000022888184
'AAAAAAAACJHCAAAA','TN',25,69.55999755859375,604.6500244140625,25.72999954223633
'AAAAAAAACJLBAAAA','TN',77,65.87999725341797,0,32.93999862670898
'AAAAAAAACKFDAAAA','TN',27,121.8000030517578,0,112.0500030517578
'AAAAAAAACKGBAAAA','TN',58,68.33000183105469,0,8.189999580383301
'AAAAAAAACKLAAAAA','TN',59,71.66999816894531,0,64.5
'AAAAAAAACLDEAAAA','TN',88,60.97000122070312,943.989990234375,24.3799991607666
'AAAAAAAACLEAAAAA','TN',25,81.94999694824219,838.2000122070312,50.79999923706055
'AAAAAAAACLJBAAAA','TN',96.5,34.85000085830688,0,14.74999976158142
'AAAAAAAACMBEAAAA','TN',68,82.16999816894531,1045.93994140625,59.15999984741211
'AAAAAAAACMCAAAAA','TN',54,38.06000137329102,0,22.06999969482422
'AAAAAAAACMCDAAAA','TN',70,44.90000152587891,0,34.56999969482422
'AAAAAAAACMOBAAAA','TN',90,62.06000137329102,3692.6201171875,47.15999984741211
'AAAAAAAACNGBAAAA','TN',95,94.34999847412109,0,70.76000213623047
'AAAAAAAACNHDAAAA','TN',81,149.6600036621094,0,136.1900024414062
---- TYPES
STRING, STRING, DOUBLE, DOUBLE, DOUBLE, DOUBLE
====