====
---- QUERY: TPCDS-Q79
SELECT
  c_last_name,
  c_first_name,
  SUBSTR(s_city, 1, 30) AS ss_city,
  ss_ticket_number,
  amt,
  profit
FROM
  (SELECT
    ss_ticket_number,
    ss_customer_sk,
    s_city,
    SUM(ss_coupon_amt) AS amt,
    SUM(ss_net_profit) AS profit
  FROM store_sales ss
  JOIN date_dim d
    ON (ss.ss_sold_date_sk = d.d_date_sk)
  JOIN household_demographics hd
    ON (ss.ss_hdemo_sk = hd.hd_demo_sk)
  JOIN store s
    ON (ss.ss_store_sk = s.s_store_sk)
  WHERE
    (hd.hd_dep_count = 8
      OR hd.hd_vehicle_count > 0)
    AND d.d_dow = 1
    AND d.d_year IN (1998, 1998 + 1, 1998 + 2)
    AND s.s_number_employees BETWEEN 200 AND 295
  GROUP BY
    ss_ticket_number,
    ss_customer_sk,
    ss_addr_sk,
    s_city
  ) ms
JOIN customer c
  ON (ms.ss_customer_sk = c.c_customer_sk)
ORDER BY
  c_last_name,
  c_first_name,
  ss_city,
  profit
LIMIT 100;
---- RESULTS
'','','Midway',217339,1865.02001953125,-17373.080078125
'','','Midway',42870,834.2100219726562,-12044.32988739014
'','','Midway',78302,2371.409942626953,-7625.249889373779
'','','Midway',234655,0,-7284.119995117188
'','','Midway',191351,3451.169921875,-5971.480113983154
'','','Midway',23868,0,-5875.890115737915
'','','Midway',144321,293.2100067138672,-3652.260049819946
'','','Midway',147115,1123.630004882812,-2803.729888916016
'','','Midway',45176,132.6499996185303,-2570.059926986694
'','','Midway',45783,533.3699951171875,545.9299639761448
'','','Midway',45176,NULL,NULL
'','Aisha','Midway',105333,227.3000068664551,1235.419952392578
'','David','Midway',108460,3969.159927368164,-17644.12011909485
'','Donna','Midway',36870,5565.130115509033,-15017.77015972137
'','Edward','Midway',62697,463.3900122046471,-3857.539993286133
'','Fred','Midway',46779,124.4300003051758,13.88993453979492
'','Laura','Midway',42843,231.6000061035156,2662.770055770874
'','Lawrence','Midway',46950,32.63000106811523,1456.900024414062
'','Linda','Fairview',208936,0,-15585.84992218018
'','Malinda','Midway',55959,7606.169921875,-9597.490219116211
'','Marilyn','Fairview',31190,191.9400024414062,-7049.73978805542
'','Marjorie','Midway',147202,1050.380016326904,-11061.74011611938
'','Nydia','Midway',88008,1084.710006713867,-1912.169998168945
'','Nydia','Midway',88008,0,NULL
'','Randy','Midway',200913,0,-14249.78002548218
'','Robert','Midway',157376,281.4300079345703,-6661.519909858704
'','Stewart','Midway',132628,3517.93994140625,-11805.42990875244
'','Wallace','Midway',6920,0,-4356.03010559082
'Adair','Evan','Fairview',117449,543.0199890136719,-2845.369904518127
'Adams','Beth','Midway',73934,2148.450042724609,-9147.510213851929
'Adams','Betty','Midway',83966,3471.229931592941,-11418.80978012085
'Adams','John','Midway',206733,5837.480047225952,-7514.770086288452
'Agnew','Elizabeth','Midway',92724,0,-585.3399887084961
'Aguayo','John','Fairview',156381,538.390007019043,444.4200615882874
'Aldrich','Evelyn','Midway',196042,13430.12012434006,-16708.58992958069
'Alexander','Annie','Midway',72228,798.9799976348877,-7804.330108642578
'Alexander','Terri','Midway',22577,6371.350151062012,-17519.42979049683
'Alexander','Terry','Midway',94984,2815.900009155273,-3256.529945373535
'Alexander','Victor','Midway',184075,4566.50000667572,-16164.12976360321
'Allison','Norma','Midway',82553,1922.939971923828,-9307.160007476807
'Allred','Deanna','Midway',223272,9482.42008972168,-16343.20022583008
'Alvarado','Richard','Midway',96623,5048.680053710938,-11932.68995666504
'Amundson','Ernest','Midway',228272,8218.460193634033,-4039.619958877563
'Anderson','Alan','Midway',31774,3141.000022888184,-3937.229975700378
'Anderson','Charles','Midway',130921,1140.649993896484,-4618.140125274658
'Anderson','Clara','Midway',181363,2615.75993347168,-10631.35987854004
'Anderson','David','Midway',31599,6697.029907226562,-12560.36024475098
'Anderson','Gerald','Midway',161201,0,-12656.36991119385
'Anderson','Jerome','Midway',139561,3409.830066680908,-10314.00002288818
'Andrews','Katrina','Midway',141027,949.6100158691406,-13883.29990768433
'Aquino','Phillip','Midway',68471,75.91999816894531,-6744.340017318726
'Aquino','Phillip','Midway',68471,NULL,NULL
'Araujo','Rita','Fairview',106877,35.36999893188477,-11537.2101855278
'Arnold','James','Midway',130582,4952.540023803711,-13765.14038538933
'Arnold','Sueann','Midway',236454,934.6099945008755,-9877.859778314829
'Ashley','Dennis','Midway',35807,149.1200037002563,-10412.98996734619
'Atkins','Margaret','Midway',55771,2935.950019836426,-14653.77972412109
'Ayala','Stacy','Midway',233483,3048.050048828125,-11899.99035644531
'Baca','Alecia','Midway',29743,0,-2811.710090637207
'Baker','Cynthia','Midway',211345,22.73999977111816,-358.8400287628174
'Baker','Cynthia','Midway',211345,NULL,NULL
'Baker','Daniel','Midway',201588,98.48999786376953,-4805.259890556335
'Banks','Max','Midway',219523,0,2428.839936256409
'Barbosa','Michelle','Midway',193719,3752.45995426178,-10620.93022358418
'Battle','Nicholas','Midway',127636,3135.659977912903,-27629.44038009644
'Beaman','Robert','Midway',238456,42.70000123977661,-6555.890007019043
'Bell','Ashley','Fairview',175080,36.2400016784668,-10657.45003604889
'Bell','Ernest','Midway',129946,1631.670003414154,-14876.49988365173
'Beltran','Scott','Midway',65875,6418.029937744141,-25914.45983123779
'Bennett','Marvin','Midway',127326,0,-4824.980026245117
'Bernal','Nilda','Midway',163603,2896.7099609375,-351.7700657844543
'Berrios','Diane','Midway',130842,2309.179931640625,-5766.489932179451
'Berry','Gary','Midway',212581,3982.839965820312,-8472.09996342659
'Best','Deborah','Midway',65605,0,-11049.07998657227
'Betz','Annie','Fairview',1266,13.94000029563904,-580.1499578952789
'Biddle','Stephanie','Midway',223551,2956.88009262085,-11076.87010765076
'Bishop','Carl','Midway',206196,1388.810001373291,-22116.56018829346
'Bishop','Gregg','Midway',214893,415.0700149536133,-15794.60003662109
'Black','Rene','Midway',136922,4578.5498046875,-4561.459872245789
'Bowling','Kory','Midway',71418,181.7700042724609,-13211.55979919434
'Bowman','Paul','Midway',233440,1496.2900390625,-4867.320106506348
'Boyd','Jeffrey','Midway',28429,6370.530057907104,-27271.12985229492
'Boyer','Juan','Midway',90668,5577.880065917969,-20716.02997970581
'Bradley','Orlando','Midway',46224,119.620002746582,-5678.230102539062
'Brady','Andrew','Midway',164461,1789.290016174316,-15536.76012420654
'Branch','Elise','Midway',160415,2953.140014648438,-1584.45987701416
'Breeden','April','Fairview',1574,8.710000038146973,-3718.250106811523
'Bright','Theresa','Midway',145651,1193.169982910156,-9642.299772262573
'Brill','Christina','Midway',232415,633.1200256347656,-11857.99995422363
'Brooks','Jeannie','Fairview',7310,1083.549989700317,-7109.820038795471
'Broussard','Clayton','Midway',238358,3823.500076293945,-15466.46990013123
'Brown','Dorothy','Midway',110640,734.1799926757812,-5448.530078887939
'Brown','Many','Fairview',227538,4310.769966125488,-9102.139949798584
'Bruno','James','Midway',162002,726.1400146484375,-1868.560028076172
'Bullock','Kathryn','Midway',128851,0,201.8600635528564
'Burgess','Andrew','Midway',24111,2946.860092163086,2954.260065078735
'Burke','Molly','Fairview',128688,1935.129959106445,-14460.0799741745
'Burton','Anna','Fairview',9353,12.22000026702881,-14602.97975158691
'Burton','David','Midway',232431,1076.529968261719,-11149.27990722656
'Burton','David','Midway',232431,0,NULL
---- TYPES
STRING, STRING, STRING, INT, DOUBLE, DOUBLE
====