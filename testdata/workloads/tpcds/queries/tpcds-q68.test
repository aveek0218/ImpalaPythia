====
---- QUERY: TPCDS-Q68
select
  c_last_name,
  c_first_name,
  ca_city,
  bought_city,
  ss_ticket_number,
  extended_price,
  extended_tax,
  list_price
from
  (select
    ss_ticket_number,
    ss_customer_sk,
    ca_city bought_city,
    sum(ss_ext_sales_price) extended_price,
    sum(ss_ext_list_price) list_price,
    sum(ss_ext_tax) extended_tax
  from
    store_sales
    join store on (store_sales.ss_store_sk = store.s_store_sk)
    join household_demographics on (store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk)
    join  customer_address on (store_sales.ss_addr_sk = customer_address.ca_address_sk)
  where
    store.s_city in('Midway', 'Fairview')
    and ss_date between '1999-01-01' and '2001-12-31'
    and dayofmonth(ss_date) in (1,2)
    and (household_demographics.hd_dep_count = 5
      or household_demographics.hd_vehicle_count = 3)
  group by
    ss_ticket_number,
    ss_customer_sk,
    ss_addr_sk,
    ca_city
  ) dn
  join  customer on (dn.ss_customer_sk = customer.c_customer_sk)
  join  customer_address current_addr on (customer.c_current_addr_sk = current_addr.ca_address_sk)
where
  current_addr.ca_city <> bought_city
order by
  c_last_name,
  ss_ticket_number 
limit 100
---- RESULTS
'','','Unionville','Woodlawn',70,14472.0100812912,383.450010150671,27139.95024108887
'','Gary','Murray','Crystal',2581,12300.39992713928,834.6000106334686,19186.90991210938
'','Kirk','Brownsville','',6444,20914.92966842651,716.0400085449219,38405.80993652344
'','Sarah','Murphy','Wildwood',16222,21125.40013885498,479.7200006246567,41287.55987548828
'','','Pleasant Valley','Bunker Hill',18775,21742.8398399353,1213.710006952286,34793.32952880859
'','','Friendship','Blue Springs',26966,15501.46990966797,538.9999957084656,29844.20947265625
'','Rene','Caledonia','Spring Valley',30016,48048.10983800888,1969.989992849529,88469.88996696472
'','Marilyn','Woodville','Brownsville',31190,13820.61018371582,894.6200017929077,30351.86004638672
'','Donna','Oak Hill','Sulphur Springs',36870,25603.09006881714,1331.749977022409,53982.96975517273
'','','Salem','',43618,22846.68000555038,794.430000372231,43131.46990251541
'','','Shiloh','Oakland',46266,25416.89023399353,1427.810015976429,45735.58047485352
'','','Guilford','Wildwood',49651,14471.23968505859,513.4699964523315,32498.07983398438
'','','','Woodville',50899,28268.14031982422,515.7799999713898,44572.11993408203
'','Larry','Oak Hill','Five Points',54597,31630.40987014771,1432.77997803688,55835.87023925781
'','','Dallas','Shady Grove',55706,22011.96018981934,313.1500005722046,53826.720703125
'','Tabatha','Harmony','Greenfield',56102,17377.83972167969,420.629994392395,38464.67010498047
'','','Centerville','Providence',62604,6898.019916534424,324.9900028407574,30892.81019592285
'','Bonnie','Liberty','Post Oak',78315,39235.34979248047,1395.41001701355,77573.48950195312
'','','Hillcrest','Antioch',78963,7283.700042724609,225.4499969482422,15079.06005859375
'','','White Oak','Florence',92664,13525.32972717285,462.859992980957,28408.35012817383
'','','Morris','Sullivan',97140,13728.71995544434,455.2400107383728,22377.36010742188
'','Andrew','Centerville','Plainview',98661,40661.37969207764,973.3099963665009,79995.509765625
'','James','Riverview','Valley View',99563,22376.23044586182,546.849999666214,42749.50015258789
'','','','Pine Grove',107222,6349.870190620422,281.5399974882603,24841.36029052734
'','Melvin','Woodville','Harmony',115030,15067.29977416992,734.8300123214722,31515.13912963867
'','','Shore Acres','Cedar Grove',115319,23956.12008666992,941.6799829006195,43679.30041503906
'','John','Fairview','Lakeside',123374,21712.41979980469,1337.390013694763,31640.02001953125
'','Ralph','Valley View','Harmony',125234,17152.88991546631,603.8100070953369,43572.89065551758
'','Emma','Brownsville','Lewis',127979,19398.95956420898,554.8500099182129,29901.06982421875
'','','','Bunker Hill',133136,15951.17032623291,341.1300078332424,30764.93920898438
'','','Waterloo','Cedar Grove',133681,12367.38977050781,543.320011138916,25178.07995605469
'','Bernadette','Ashland','Pleasant Grove',134217,6757.459865570068,306.6500099897385,17709.07952880859
'','Joseph','Springdale','Lakeside',134343,17381.4699420929,748.3099882602692,37418.87020111084
'','','Lakewood','Woodland',135684,33495.94980430603,972.6600081920624,66171.41932678223
'','Rosalba','Oak Grove','Cedar Grove',137323,18895.00018310547,438.200005531311,40219.12036132812
'','Gertrude','Greenwood','Macedonia',137410,33678.20997238159,1866.589982658625,47276.52043151855
'','Susan','Green Acres','Liberty',143399,13352.11005210876,880.6100070923567,30549.4698638916
'','','Arlington','Lincoln',145409,23308.54054260254,642.9800114631653,30534.70001220703
'','','Walnut Grove','Willow',147740,24550.36961364746,1403.660033106804,47888.98928833008
'','','Fairfield','Wildwood',148926,15095.93976211548,737.2499712705612,27388.88983154297
'','','Pleasant Hill','Waterloo',156554,20178.41027832031,1143.870012283325,34449.89013671875
'','Victor','Providence','Antioch',161524,14173.12005996704,860.0700030326843,26079.25003051758
'','','Centerville','',171076,6706.91008913517,269.1100027561188,19594.54990386963
'','David','Oakdale','Newport',175933,15600.68989944458,781.2000062465668,23380.38031005859
'','','Kingston','Wildwood',176614,38949.48978900909,2260.340005993843,62962.62926673889
'','George','Pleasant Grove','Shiloh',179953,18237.83992767334,607.5700051784515,44135.37922668457
'','Kathleen','Little River','Woodlawn',189811,25583.859375,1115.109986305237,55842.99114990234
'','Antone','Antioch','Forest Hills',192973,14507.02018165588,841.8599848151207,34973.08055114746
'','','Mountain View','Deerfield',194436,16962.71983337402,773.9700093269348,33070.53991699219
'','','Mount Pleasant','Greenville',206301,20248.07989501953,682.3699941635132,57143.50012207031
'','','Hillcrest','Brownsville',211170,27404.60033798218,982.539999127388,47560.1900100708
'','Robert','Mount Zion','Liberty',227572,8797.999831199646,400.9100034236908,37292.3098449707
'','Joseph','Lakewood','Mount Olive',231104,34934.39022064209,1256.890029430389,55986.83993530273
'','Shannon','Brownsville','Bridgeport',231932,9441.739921569824,356.3700008392334,17181.28019714355
'','Ashley','Cedar Grove','Unionville',232883,24038.02037811279,860.1099879145622,51269.93881225586
'','Judy','Antioch','Fairfield',234350,30165.18993377686,1390.40000462532,73919.46035766602
'','','Fisher','',234655,20093.4599609375,279.930004119873,39719.79016113281
'Adair','Evan','Blanchard','New Hope',117449,10843.00998497009,540.0799882411957,20084.00995635986
'Adams','Jacqueline','Gum Springs','Springdale',110641,22901.72947692871,995.740008354187,62231.69982910156
'Adcock','Sarah','Stringtown','',156507,21331.10000228882,829.7099970579147,54881.71041870117
'Adkins','John','Greenville','Springdale',33263,20939.55024528503,546.0099973678589,45397.81986999512
'Aguayo','John','Newport','Newtown',156381,17114.16985702515,567.090004324913,30022.52029037476
'Aguayo','Jeanne','Glendale','Hopewell',199409,29035.36982727051,1374.339986801147,53784.57037353516
'Aguilar','Arlene','Ashland','Brownsville',121548,31984.00930786133,1162.650001525879,50601.98052978516
'Aiello','Beth','Red Hill','Oak Ridge',116426,17609.85985946655,444.6599932312965,30611.15069580078
'Alexander','Robert','Woodlawn','Arlington',174134,28340.20040893555,914.4599959850311,51978.95053100586
'Allen','William','Lewis','Springdale',101791,20167.14984130859,1076.200007915497,25099.71041870117
'Allison','Elsie','Shiloh','Harmony',201869,14130.0997467041,563.7099995613098,27916.98999023438
'Alvarado','Tyson','Pleasant Grove','Midway',187704,21663.47009277344,1230.219980239868,40665.03997802734
'Alvarez','Kenneth','Shady Grove','Woodville',59985,10407.46993255615,575.0399918556213,21834.74975585938
'Alves','Sam','Mount Olive','Union Hill',129660,22050.59029006958,820.7999910116196,42100.02953338623
'Ames','Gregory','Summerfield','Carthage',239041,24406.600025177,890.3199806213379,48047.24932861328
'Anderson','Alan','Bunker Hill','Oakdale',31774,27005.33993530273,1103.940011739731,40676.60989379883
'Anderson','Marcia','Clifton','Belmont',156087,15630.24987578392,586.01999027282,36680.53948974609
'Anderson','Gerald','Centerville','Hamilton',161201,11833.74003601074,556.9699954986572,28705.57984924316
'Anderson','Latasha','Florence','Altamont',187946,14746.73004150391,254.7900009155273,31702.669921875
'Anderson','John','Valley View','Pleasant Valley',207323,24052.32988739014,890.9099967479706,40618.13006591797
'Anderson','Willie','Oakwood','Clifton',209106,19448.15980529785,1078.960007190704,42014.22944641113
'Andres','Michael','Union','Macedonia',82789,24968.32985305786,1230.169993281364,52634.72941589355
'Andrews','Everett','Macedonia','Shiloh',96502,26992.87957000732,1166.22996544838,48674.39936828613
'Angel','Claudette','Sunnyside','Edgewood',196703,40487.65982437134,2101.66998821497,74569.91044616699
'Armijo','Bryan','Pleasant Grove','Woodbury',91994,13606.26007461548,864.100004196167,42234.98043823242
'Ashby','Jeanne','Wildwood','Oakwood',28839,21247.3402557373,1166.930011987686,25034.56992340088
'Ashby','Jeanne','Wildwood','Red Hill',68727,30389.59999847412,1249.659976005554,56864.88027954102
'Ashby','Edward','Five Forks','Shady Grove',128122,18946.94031524658,886.9400004148483,42333.4598236084
'Ashmore','Karen','Cedar Grove','Sulphur Springs',35216,23105.58028411865,1288.000020265579,42468.0103225708
'Ashton','Patrice','Five Points','Midway',93920,9836.869956970215,461.7999945878983,28264.2095413208
'Atkinson','Cedric','Red Hill','Summit',194465,30255.47012329102,1199.929982185364,48718.92977905273
'Augustine','Sylvia','','Ferguson',239026,22667.0004196167,1224.460002094507,45997.46026229858
'Austin','Molly','Greenville','Midway',233037,21252.56999206543,433.6300029754639,36658.60046386719
'Avila','Ashley','Clinton','Summit',214308,19752.6001739502,476.8699998855591,47445.76904296875
'Ayala','Stacy','Macedonia','Fairview',233483,21589.41009521484,944.7299900054932,50167.52978515625
'Bailey','Eric','Sardis','Woodland',147711,21941.79993438721,482.3199918270111,46136.80966186523
'Bailey','Robert','Mountain View','Lakeview',234709,22616.9296875,831.49998909235,55324.78997802734
'Bair','Jennifer','Wilson','Woodlawn',167321,26362.83995819092,590.5299832820892,39739.10034942627
'Baker','Robert','','Clinton',28481,44244.05026531219,1804.300007909536,75129.16967773438
'Baker','Joel','Sulphur Springs','Lincoln',48913,17417.92014503479,829.4499840736389,33206.22928619385
'Baker','Richard','Five Forks','Greenfield',110320,20924.76001739502,1460.23002743721,41027.93966674805
'Baker','Jose','Pine Grove','Waterloo',123104,18081.53002929688,581.1000113487244,31182.25967407227
'Baker','Pamela','Mount Olive','Marion',137661,19432.40991592407,322.6400018930435,29972.42016601562
---- TYPES
STRING, STRING, STRING, STRING, INT, DOUBLE, DOUBLE, DOUBLE
====